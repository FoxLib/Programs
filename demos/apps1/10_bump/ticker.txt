Сегодня я решил выложить еще один занимательный эффект, который раскопал
из своих архивов, написанных на Quick Basic 4.5. Скорость работы на Бейсике
оставляла желать лучшего и я переписал алгоритм на С. Этот алгоритм работает
достаточно просто - перед рендерингом вычисляются нормали к каждой точке.
Нормаль, на самом деле, не совсем нормаль - тут всего лишь грубое приближение,
потому, чтобы вычислить нормаль, берется разность высот по X и по Y между
точками. При отрисовке картинки, вычисляется зеркальное отражение по
формуле 2*N-(L-C), где L-положение источника света, а C-точка, которая
рисуется, N-нормаль в этой точке. У полученного вектора берется его длина.
Чем больше длина вектора - тем, получается, сильнее наклонен луч света
к этой точке, а значит, менее яркий свет должен прийи в камеру. Если
угол отражения нулевой - это значит, что все что приходит от света, отражается
обратно, и уровень освещения максимальный. Вот так вот незатейливо и
просто работает этот алгоритм.
